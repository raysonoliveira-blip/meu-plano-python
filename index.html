<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Plano de Estudo Interativo de Python</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
    <!-- Chosen Palette: Warm Neutrals -->
    <!-- Application Structure Plan: A single-page, tab-based interactive roadmap for an 8-week Python study plan. Each tab represents a week, revealing a daily schedule with goals and resources. This structure breaks down the learning process into manageable steps, preventing user overwhelm, and promoting focus. A progress chart visualizes the cumulative knowledge gained, offering motivation. This is more effective than a static document because it's interactive, trackable, and less intimidating for a beginner. -->
    <!-- Visualization & Content Choices: Report Info: Request for an 8-week Python plan -> Goal: Organize and motivate learning -> Viz/Presentation Method: An interactive weekly tab system for the plan and a line chart for progress visualization -> Interaction: Users click tabs to switch weeks and see their learning path on the chart. -> Justification: Tabs provide focused navigation, while the chart offers a clear, motivating overview of the learning journey. -> Library/Method: HTML/Tailwind for structure, Chart.js (Canvas) for visualization. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #FDFBF8;
            color: #4A4A4A;
        }
        .tab-button {
            transition: all 0.3s ease;
            border-bottom: 2px solid transparent;
        }
        .tab-button.active {
            border-color: #4F46E5;
            color: #4F46E5;
            font-weight: 600;
        }
        .card {
            background-color: #FFFFFF;
            border-radius: 12px;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            transition: all 0.3s ease;
        }
        .task-item {
            border-left: 4px solid #E5E7EB;
        }
        .task-item h4 {
            color: #111827;
        }
        .resource-link {
            color: #4F46E5;
            text-decoration: none;
            transition: color 0.2s;
            display: block;
            margin-top: 8px;
        }
        .resource-link:hover {
            color: #312E81;
            text-decoration: underline;
        }
        .goal-card {
            background-color: #EEF2FF;
            border-left: 4px solid #4F46E5;
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
            height: 300px;
            max-height: 400px;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 400px;
            }
        }
        /* Coach Styles */
        #coach-modal {
            transition: opacity 0.3s ease-in-out, transform 0.3s ease-in-out;
        }
        .coach-message.user {
            background-color: #DBEAFE;
            align-self: flex-end;
        }
        .coach-message.model {
            background-color: #F3F4F6;
            align-self: flex-start;
        }
        .typing-indicator span {
            animation: bounce 1.4s infinite ease-in-out both;
        }
        .typing-indicator span:nth-child(1) { animation-delay: -0.32s; }
        .typing-indicator span:nth-child(2) { animation-delay: -0.16s; }
        @keyframes bounce {
            0%, 80%, 100% { transform: scale(0); }
            40% { transform: scale(1.0); }
        }
        /* Progress Tracker Styles */
        .rating-star {
            cursor: pointer;
            color: #D1D5DB; /* gray-300 */
            transition: color 0.2s;
        }
        .rating-star:hover,
        .rating-star.selected {
            color: #FBBF24; /* amber-400 */
        }
    </style>
</head>
<body class="antialiased">
    <div class="container mx-auto px-4 sm:px-6 lg:px-8 py-12">
        <header class="text-center mb-12">
            <h1 class="text-4xl md:text-5xl font-bold text-gray-800">Plano de Estudo Python</h1>
            <p class="mt-4 text-lg text-gray-600">A sua jornada de 8 semanas, do zero ao b√°sico, com 2 horas por dia.</p>
        </header>

        <main>
            <section id="plan" class="mb-16">
                <div class="mb-8 border-b border-gray-200">
                    <nav class="-mb-px flex flex-wrap justify-center space-x-2 sm:space-x-4 lg:space-x-8" aria-label="Tabs">
                    </nav>
                </div>
                <div id="plan-content">
                </div>
            </section>

             <!-- New Progress Tracker Section -->
            <section id="progress-tracker" class="mb-16">
                <h2 class="text-3xl font-bold text-gray-800 text-center mb-2">Meu Di√°rio de Bordo</h2>
                <p class="text-gray-600 text-center mb-8 max-w-2xl mx-auto">Registe aqui as suas sess√µes de estudo para acompanhar o seu progresso e manter o seu gr√°fico atualizado.</p>
                <div class="grid md:grid-cols-2 gap-8 items-start">
                    <div class="card p-6">
                        <h3 class="text-xl font-bold text-gray-800 mb-4">Registar Nova Sess√£o</h3>
                        <form id="log-form" class="space-y-4">
                            <div>
                                <label for="week-select" class="block text-sm font-medium text-gray-700">Semana</label>
                                <select id="week-select" class="mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md"></select>
                            </div>
                            <div>
                                <label for="hours-input" class="block text-sm font-medium text-gray-700">Horas Estudadas</label>
                                <input type="number" id="hours-input" min="0.5" step="0.5" required class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700">N√≠vel de Confian√ßa</label>
                                <div id="rating-stars" class="mt-1 flex space-x-1">
                                    <!-- Stars will be injected here -->
                                </div>
                                <input type="hidden" id="rating-value" value="0">
                            </div>
                            <div>
                                <label for="notes-input" class="block text-sm font-medium text-gray-700">Notas sobre o que aprendi</label>
                                <textarea id="notes-input" rows="3" class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm" placeholder="Ex: Entendi bem as fun√ß√µes, mas preciso praticar mais os dicion√°rios."></textarea>
                            </div>
                            <button type="submit" id="log-submit-button" class="w-full bg-indigo-600 text-white py-2 px-4 rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50">Registar</button>
                        </form>
                    </div>
                    <div class="card p-6">
                         <h3 class="text-xl font-bold text-gray-800 mb-4">Hist√≥rico de Estudos</h3>
                         <div id="log-list" class="space-y-4 max-h-[450px] overflow-y-auto pr-2">
                            <p id="log-placeholder" class="text-gray-500 text-center py-8">Ainda n√£o h√° registos. Comece a sua primeira sess√£o de estudo!</p>
                         </div>
                    </div>
                </div>
            </section>

            <section id="progress" class="text-center">
                <h2 id="progress-title" class="text-3xl font-bold text-gray-800 text-center mb-2">A Sua Trilha de Aprendizagem</h2>
                <p class="text-gray-600 mb-8 max-w-2xl mx-auto">Este gr√°fico √© atualizado em tempo real com as horas que registou no seu Di√°rio de Bordo. √â o seu esfor√ßo, visualizado.</p>
                <div class="card p-4 sm:p-6">
                    <div class="chart-container">
                        <canvas id="progressChart"></canvas>
                    </div>
                </div>
            </section>

            <section id="next-steps" class="mt-16 text-center">
                 <h2 class="text-3xl font-bold text-gray-800 mb-4">E depois das 8 semanas?</h2>
                 <div class="max-w-4xl mx-auto text-left grid md:grid-cols-2 gap-8">
                     <div class="card p-6">
                         <h3 class="text-xl font-bold text-gray-800 mb-3">Aprofunde os Seus Conhecimentos</h3>
                         <p class="text-gray-600">Com a base s√≥lida que construiu, agora √© hora de explorar √°reas espec√≠ficas. Escolha um caminho que lhe interesse e mergulhe fundo!</p>
                         <ul class="mt-4 space-y-2 list-disc list-inside text-gray-600">
                             <li><strong>Desenvolvimento Web:</strong> Aprenda frameworks como Django ou Flask.</li>
                             <li><strong>Ci√™ncia de Dados:</strong> Explore bibliotecas como Pandas, NumPy e Matplotlib.</li>
                             <li><strong>Automa√ß√£o:</strong> Use scripts Python para automatizar tarefas repetitivas.</li>
                             <li><strong>Intelig√™ncia Artificial:</strong> D√™ os primeiros passos com Scikit-learn e TensorFlow.</li>
                         </ul>
                     </div>
                     <div class="card p-6">
                         <h3 class="text-xl font-bold text-gray-800 mb-3">Pratique Constantemente</h3>
                         <p class="text-gray-600">A programa√ß√£o √© uma habilidade que melhora com a pr√°tica. Continue a resolver desafios e a construir projetos pessoais.</p>
                         <ul class="mt-4 space-y-2">
                             <li>üöÄ <a href="https://www.beecrowd.com.br" target="_blank" class="resource-link">Beecrowd</a></li>
                             <li>üíª <a href="https://www.hackerrank.com" target="_blank" class="resource-link">HackerRank</a></li>
                             <li>üí° <a href="https://www.codewars.com" target="_blank" class="resource-link">CodeWars</a></li>
                             <li>üìÇ Crie o seu portf√≥lio no <a href="https://github.com" target="_blank" class="resource-link">GitHub</a> para mostrar os seus projetos.</li>
                         </ul>
                     </div>
                 </div>
            </section>
        </main>
    </div>

    <!-- Coach Components -->
    <button id="coach-button" class="fixed bottom-6 right-6 bg-indigo-600 text-white p-4 rounded-full shadow-lg hover:bg-indigo-700 transition-transform transform hover:scale-110 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" viewBox="0 0 20 20" fill="currentColor">
            <path d="M10 9a3 3 0 100-6 3 3 0 000 6zM10 11a6 6 0 016 6H4a6 6 0 016-6z" />
            <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm-5.922-1.39a6.012 6.012 0 0111.844 0H4.078z" clip-rule="evenodd" />
        </svg>
    </button>
    
    <div id="coach-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 hidden opacity-0 scale-95">
        <div class="bg-white rounded-2xl shadow-2xl w-full max-w-lg flex flex-col h-[80vh] max-h-[700px]">
            <header class="flex items-center justify-between p-4 border-b">
                <div class="flex items-center space-x-3">
                    <div class="bg-indigo-100 p-2 rounded-full">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-indigo-600" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z" /></svg>
                    </div>
                    <h3 class="text-lg font-bold text-gray-800">Seu Coach Python</h3>
                </div>
                <button id="close-coach-modal" class="text-gray-400 hover:text-gray-600">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg>
                </button>
            </header>
            <div id="chat-window" class="flex-grow p-4 overflow-y-auto space-y-4">
            </div>
            <div id="typing-indicator" class="p-4 hidden">
                <div class="flex items-center space-x-2">
                    <div class="typing-indicator">
                        <span class="w-2 h-2 bg-gray-400 rounded-full inline-block"></span>
                        <span class="w-2 h-2 bg-gray-400 rounded-full inline-block"></span>
                        <span class="w-2 h-2 bg-gray-400 rounded-full inline-block"></span>
                    </div>
                    <span class="text-sm text-gray-500">PyCoach est√° a digitar...</span>
                </div>
            </div>
            <footer class="p-4 border-t">
                <form id="chat-form" class="flex items-center space-x-2">
                    <input type="text" id="chat-input" placeholder="Pergunte algo sobre Python..." class="w-full px-4 py-2 border rounded-full focus:outline-none focus:ring-2 focus:ring-indigo-500" autocomplete="off">
                    <button type="submit" class="bg-indigo-600 text-white p-3 rounded-full hover:bg-indigo-700 transition focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 10l7-7m0 0l7 7m-7-7v18" /></svg>
                    </button>
                </form>
            </footer>
        </div>
    </div>
    
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, onAuthStateChanged, signInAnonymously } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, collection, addDoc, onSnapshot, query, serverTimestamp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        const firebaseConfig = typeof __firebase_config !== 'undefined' ? JSON.parse(__firebase_config) : {};
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';

        let db, auth;
        let userId;
        let isFirebaseReady = false;

        try {
            const app = initializeApp(firebaseConfig);
            db = getFirestore(app);
            auth = getAuth(app);
            
            onAuthStateChanged(auth, async (user) => {
                if (user) {
                    userId = user.uid;
                } else {
                    await signInAnonymously(auth);
                }
                isFirebaseReady = true;
                listenToLogs();
            });

        } catch (e) {
            console.error("Firebase initialization failed:", e);
        }

        // ... (Existing script for study plan)
        const studyPlan = [
            { week: 0, title: "Semana 0: Prepara√ß√£o", goal: "Configurar o seu ambiente de desenvolvimento e escrever o seu primeiro 'Ol√°, Mundo!'.", schedule: { "Segunda": { topic: "O que √© e porque aprender Python?", resources: [{ text: "V√≠deo: Porque √© que o Python √© t√£o popular?", url: "https://www.youtube.com/watch?v=S9uPNppGsGo" }] }, "Ter√ßa": { topic: "A instalar o Python", resources: [{ text: "V√≠deo: Instala√ß√£o do Python no Windows (Curso em V√≠deo)", url: "https://www.youtube.com/watch?v=ElRd0cbXIv4" }, { text: "Guia: Site Oficial do Python", url: "https://www.python.org/downloads/" }] }, "Quarta": { topic: "A instalar e configurar o VS Code para Python", resources: [{ text: "V√≠deo Oficial: Introdu√ß√£o ao Python no VS Code (Microsoft)", url: "https://www.youtube.com/watch?v=7EXd4_ttIuw" }, { text: "Guia em Texto (Oficial): Tutorial VS Code", url: "https://code.visualstudio.com/docs/python/python-tutorial" }] }, "Quinta": { topic: "O seu primeiro programa: 'Ol√°, Mundo!'", resources: [{ text: "V√≠deo Principal: O seu Primeiro C√≥digo (Hashtag Programa√ß√£o)", url: "https://www.youtube.com/watch?v=GQpQha2Mfpg" }] }, "Sexta": { topic: "Revis√£o e Experimenta√ß√£o", resources: [{ text: "Pr√°tica: Modifique o 'Ol√°, Mundo!' para exibir mensagens diferentes." }] } } },
            { week: 1, title: "Semana 1: Fundamentos", goal: "Entender o que s√£o vari√°veis, tipos de dados b√°sicos e como fazer opera√ß√µes matem√°ticas simples.", schedule: { "Segunda": { topic: "Vari√°veis e Tipos de Dados (int, float, bool, str)", resources: [{ text: "V√≠deo: Tipos Primitivos", url: "https://www.youtube.com/watch?v=hdDHg1p3YVc" }] }, "Ter√ßa": { topic: "Operadores Aritm√©ticos (+, -, *, /, %, **)", resources: [{ text: "V√≠deo: Operadores Aritm√©ticos", url: "https://www.youtube.com/watch?v=Vw6gLypRKmY" }] }, "Quarta": { topic: "Fun√ß√µes `print()` e `input()`", resources: [{ text: "Pr√°tica: Crie um script que pede o nome do utilizador e o cumprimenta." }] }, "Quinta": { topic: "Manipula√ß√£o de Strings (B√°sico)", resources: [{ text: "V√≠deo: A manipular Textos", url: "https://www.youtube.com/watch?v=a7ryie6Nuzo" }] }, "Sexta": { topic: "Projeto da Semana: Calculadora Simples", resources: [{ text: "Desafio: Crie um programa que pede dois n√∫meros e mostra a soma, subtra√ß√£o, multiplica√ß√£o e divis√£o." }] } } },
            { week: 2, title: "Semana 2: L√≥gica e Decis√µes", goal: "Aprender a controlar o fluxo do seu programa com condi√ß√µes e a tomar decis√µes baseadas em dados.", schedule: { "Segunda": { topic: "Operadores L√≥gicos (and, or, not) e Relacionais (==, !=, >, <)", resources: [{ text: "Documenta√ß√£o: Express√µes Booleanas", url: "https://docs.python.org/pt-br/3/library/stdtypes.html#boolean-operations-and-or-not" }] }, "Ter√ßa": { topic: "Estruturas Condicionais: `if`, `else`", resources: [{ text: "V√≠deo: Condi√ß√µes (Parte 1)", url: "https://www.youtube.com/watch?v=K10u3XIf1-Q" }] }, "Quarta": { topic: "Estruturas Condicionais: `elif`", resources: [{ text: "V√≠deo: Condi√ß√µes Aninhadas", url: "https://www.youtube.com/watch?v=cXLdV91D_2I" }] }, "Quinta": { topic: "Pr√°tica com Condicionais", resources: [{ text: "Desafio: Crie um programa que verifica se uma pessoa pode votar com base na idade." }] }, "Sexta": { topic: "Projeto da Semana: Jogo de Adivinhar o N√∫mero", resources: [{ text: "Desafio: Fa√ßa um jogo onde o computador 'pensa' num n√∫mero e o utilizador tenta adivinhar." }] } } },
            { week: 3, title: "Semana 3: Repeti√ß√µes e Listas", goal: "Aprender a repetir tarefas com la√ßos e a armazenar m√∫ltiplos valores em listas.", schedule: { "Segunda": { topic: "La√ßo de Repeti√ß√£o `while`", resources: [{ text: "V√≠deo: Estrutura de Repeti√ß√£o `while`", url: "https://www.youtube.com/watch?v=d_kS_5pYj1Q" }] }, "Ter√ßa": { topic: "La√ßo de Repeti√ß√£o `for` e `range()`", resources: [{ text: "V√≠deo: Estrutura de Repeti√ß√£o `for`", url: "https://www.youtube.com/watch?v=iF2MdbrG_0s" }] }, "Quarta": { topic: "Introdu√ß√£o a Listas", resources: [{ text: "V√≠deo: Vari√°veis Compostas (Listas)", url: "https://www.youtube.com/watch?v=N1hTsbW_ezo" }] }, "Quinta": { topic: "A manipular Listas (adicionar, remover, aceder)", resources: [{ text: "Pr√°tica: Crie uma lista de compras e permita ao utilizador adicionar e remover itens." }] }, "Sexta": { topic: "Projeto da Semana: Lista de Tarefas", resources: [{ text: "Desafio: Crie um programa de lista de tarefas onde o utilizador pode ver, adicionar e marcar tarefas como conclu√≠das." }] } } },
            { week: 4, title: "Semana 4: Fun√ß√µes e Dicion√°rios", goal: "Organizar o seu c√≥digo em blocos reutiliz√°veis com fun√ß√µes e aprender a usar dicion√°rios para dados mais complexos.", schedule: { "Segunda": { topic: "Introdu√ß√£o a Fun√ß√µes (def, return)", resources: [{ text: "V√≠deo: Fun√ß√µes (Parte 1)", url: "https://www.youtube.com/watch?v=u4_cr_J_AbE" }] }, "Ter√ßa": { topic: "Par√¢metros e √Çmbito de Vari√°veis", resources: [{ text: "V√≠deo: Fun√ß√µes (Parte 2)", url: "https://www.youtube.com/watch?v=SifYYsXhLM8" }] }, "Quarta": { topic: "Introdu√ß√£o a Dicion√°rios", resources: [{ text: "V√≠deo: Dicion√°rios", url: "https://www.youtube.com/watch?v=7acDQYn_G3E" }] }, "Quinta": { topic: "A manipular Dicion√°rios", resources: [{ text: "Pr√°tica: Crie um dicion√°rio para armazenar informa√ß√µes de um utilizador (nome, idade, cidade)." }] }, "Sexta": { topic: "Projeto da Semana: Agenda de Contactos", resources: [{ text: "Desafio: Use um dicion√°rio para criar uma agenda onde pode adicionar, remover e procurar contactos." }] } } },
            { week: 5, title: "Semana 5: M√≥dulos e Erros", goal: "Aprender a usar c√≥digo de outras pessoas (m√≥dulos) e a lidar com erros inesperados de forma elegante.", schedule: { "Segunda": { topic: "A importar M√≥dulos (math, random)", resources: [{ text: "V√≠deo: M√≥dulos e Pacotes", url: "https://www.youtube.com/watch?v=oV1hS46i_b4" }] }, "Ter√ßa": { topic: "Tratamento de Exce√ß√µes (try, except)", resources: [{ text: "V√≠deo: Tratamento de Erros e Exce√ß√µes", url: "https://www.youtube.com/watch?v=6S-S2p_3a20" }] }, "Quarta": { topic: "Cl√°usulas `else` e `finally` no tratamento de erros", resources: [{ text: "Documenta√ß√£o: A tratar Exce√ß√µes", url: "https://docs.python.org/pt-br/3/tutorial/errors.html" }] }, "Quinta": { topic: "Pr√°tica com M√≥dulos e Exce√ß√µes", resources: [{ text: "Desafio: Melhore a calculadora da Semana 1 para n√£o quebrar se o utilizador digitar um texto em vez de um n√∫mero." }] }, "Sexta": { topic: "Projeto da Semana: Gerador de Palavras-passe", resources: [{ text: "Desafio: Crie um programa que gera palavras-passe aleat√≥rias com um tamanho definido pelo utilizador, usando o m√≥dulo `random`." }] } } },
            { week: 6, title: "Semana 6: Manipula√ß√£o de Ficheiros", goal: "Fazer os seus programas guardarem e lerem informa√ß√µes de ficheiros, tornando os dados persistentes.", schedule: { "Segunda": { topic: "A ler Ficheiros de Texto (.txt)", resources: [{ text: "Tutorial: Leitura e Escrita de Ficheiros", url: "https://realpython.com/read-write-files-python/" }] }, "Ter√ßa": { topic: "A escrever e adicionar conte√∫do em ficheiros", resources: [{ text: "Pr√°tica: Crie um script que pede ao utilizador para escrever uma frase e a guarda num 'diario.txt'." }] }, "Quarta": { topic: "Gestor de Contexto `with open()`", resources: [{ text: "Explica√ß√£o: Porque usar 'with'?", url: "https://pylessons.com/with-statement-in-python" }] }, "Quinta": { topic: "Revis√£o e Pr√°tica", resources: [{ text: "Desafio: Leia o ficheiro 'diario.txt' e exiba o seu conte√∫do na consola." }] }, "Sexta": { topic: "Projeto da Semana: Guardar a Agenda", resources: [{ text: "Desafio: Modifique a agenda de contactos da Semana 4 para guardar os contactos num ficheiro e carreg√°-los ao iniciar." }] } } },
            { week: 7, title: "Semana 7: Orienta√ß√£o a Objetos", goal: "Introdu√ß√£o ao paradigma de Programa√ß√£o Orientada a Objetos (POO), uma forma poderosa de estruturar programas maiores.", schedule: { "Segunda": { topic: "Conceitos de POO: Classes e Objetos", resources: [{ text: "V√≠deo: O que √© a Programa√ß√£o Orientada a Objetos?", url: "https://www.youtube.com/watch?v=GLE-z99q_2o" }] }, "Ter√ßa": { topic: "A criar a sua primeira Classe e Atributos", resources: [{ text: "V√≠deo: Classes em Python na Pr√°tica", url: "https://www.youtube.com/watch?v=mprk0g9Sgok" }] }, "Quarta": { topic: "M√©todos e o Construtor `__init__`", resources: [{ text: "Pr√°tica: Crie uma classe 'Carro' com atributos como 'marca', 'modelo' e 'ano'." }] }, "Quinta": { topic: "A instanciar Objetos e a usar M√©todos", resources: [{ text: "Pr√°tica: Adicione m√©todos como 'ligar()' e 'acelerar()' √† sua classe Carro." }] }, "Sexta": { topic: "Projeto da Semana: Modela√ß√£o", resources: [{ text: "Desafio: Crie uma classe 'ContaBancaria' com atributos (saldo, titular) e m√©todos (depositar, sacar)." }] } } },
            { week: 8, title: "Semana 8: Projeto Final", goal: "Consolidar todo o conhecimento adquirido num projeto pr√°tico que integra os principais conceitos aprendidos.", schedule: { "Segunda": { topic: "Planeamento do Projeto Final", resources: [{ text: "Tarefa: Defina as funcionalidades do seu sistema de gest√£o de uma 'Biblioteca Pessoal'." }] }, "Ter√ßa": { topic: "Desenvolvimento: Classes e Estrutura de Dados", resources: [{ text: "Desafio: Crie a classe 'Livro' e decida como armazenar a sua cole√ß√£o de livros (lista de objetos)." }] }, "Quarta": { topic: "Desenvolvimento: Fun√ß√µes Principais", resources: [{ text: "Desafio: Implemente as fun√ß√µes para adicionar, remover e listar livros." }] }, "Quinta": { topic: "Desenvolvimento: Persist√™ncia de Dados", resources: [{ text: "Desafio: Fa√ßa o sistema guardar a sua biblioteca num ficheiro e carregar ao iniciar." }] }, "Sexta": { topic: "Revis√£o, Refatora√ß√£o e Comemora√ß√£o!", resources: [{ text: "Parab√©ns! Reveja o seu c√≥digo, melhore o que for poss√≠vel e comemore a sua conquista!" }] } } }
        ];

        const navContainer = document.querySelector('nav');
        const contentContainer = document.getElementById('plan-content');
        let currentWeek = 0;
        let progressChart;
        
        function renderPlan(weekIndex) {
            const weekData = studyPlan.find(w => w.week === weekIndex);
            if (!weekData) return;
            currentWeek = weekIndex;
            contentContainer.innerHTML = `<div class="card p-6 md:p-8 animate-fade-in"><h3 class="text-2xl font-bold text-gray-800">${weekData.title}</h3><div class="goal-card p-4 my-6"><p class="font-semibold text-indigo-800">üéØ Meta da Semana:</p><p class="text-indigo-700">${weekData.goal}</p></div><div class="space-y-6">${Object.entries(weekData.schedule).map(([day, details]) => `<div class="task-item pl-4 py-2"><span class="text-sm font-semibold text-gray-500 uppercase">${day}</span><h4 class="text-lg font-semibold mt-1">${details.topic}</h4><div class="mt-2 text-sm">${details.resources.map(res => res.url ? `<a href="${res.url}" target="_blank" class="resource-link flex items-center space-x-2 group"><svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14" /></svg><span>${res.text}</span></a>` : `<span class="text-gray-600">${res.text}</span>`).join('')}</div></div>`).join('')}</div></div>`;
            document.querySelectorAll('.tab-button').forEach(btn => {
                btn.classList.toggle('active', parseInt(btn.dataset.week) === weekIndex);
            });
            updateChartHighlight();
        }
        function setupTabs() {
            studyPlan.forEach(week => {
                const button = document.createElement('button');
                button.className = 'tab-button py-3 px-2 sm:px-4 text-sm md:text-base font-medium text-gray-500 hover:text-indigo-600';
                button.textContent = `Semana ${week.week}`;
                button.dataset.week = week.week;
                button.addEventListener('click', () => renderPlan(week.week));
                navContainer.appendChild(button);
            });
        }
        function createChart() {
            const ctx = document.getElementById('progressChart').getContext('2d');
            const labels = studyPlan.map(w => `Semana ${w.week}`);
            progressChart = new Chart(ctx, { type: 'line', data: { labels: labels, datasets: [{ label: 'Horas Estudadas', data: Array(labels.length).fill(0), borderColor: 'rgba(79, 70, 229, 1)', backgroundColor: 'rgba(79, 70, 229, 0.1)', borderWidth: 3, pointBackgroundColor: 'rgba(79, 70, 229, 1)', pointBorderColor: '#fff', pointHoverBackgroundColor: '#fff', pointHoverBorderColor: 'rgba(79, 70, 229, 1)', pointRadius: 5, pointHoverRadius: 7, fill: true, tension: 0.3 }] }, options: { responsive: true, maintainAspectRatio: false, scales: { y: { beginAtZero: true, grid: { color: '#E5E7EB', }, title: { display: true, text: 'Horas'} }, x: { grid: { display: false } } }, plugins: { legend: { display: false }, tooltip: { enabled: true, backgroundColor: '#111827', titleFont: { size: 14 }, bodyFont: { size: 12 }, padding: 10, cornerRadius: 4, displayColors: false } } } });
        }
        function updateChartHighlight() {
            if (!progressChart) return;
            const pointColors = studyPlan.map((w, index) => w.week === currentWeek ? 'rgba(236, 72, 153, 1)' : 'rgba(79, 70, 229, 1)');
            progressChart.data.datasets[0].pointBackgroundColor = pointColors;
            progressChart.update();
        }
        
        const logForm = document.getElementById('log-form');
        const weekSelect = document.getElementById('week-select');
        const ratingStarsContainer = document.getElementById('rating-stars');
        const ratingValueInput = document.getElementById('rating-value');
        const logList = document.getElementById('log-list');
        const logPlaceholder = document.getElementById('log-placeholder');
        
        function setupProgressTracker() {
            studyPlan.forEach(week => {
                const option = document.createElement('option');
                option.value = week.week;
                option.textContent = `Semana ${week.week}: ${week.title.split(': ')[1]}`;
                weekSelect.appendChild(option);
            });

            for(let i = 1; i <= 5; i++) {
                const star = document.createElement('span');
                star.innerHTML = `<svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20"><path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z" /></svg>`;
                star.classList.add('rating-star');
                star.dataset.value = i;
                ratingStarsContainer.appendChild(star);
            }
            
            ratingStarsContainer.addEventListener('click', (e) => {
                const star = e.target.closest('.rating-star');
                if(!star) return;
                const value = parseInt(star.dataset.value);
                ratingValueInput.value = value;
                updateStarDisplay(value);
            });

            logForm.addEventListener('submit', handleLogSubmit);
        }

        function updateStarDisplay(value) {
            const stars = ratingStarsContainer.querySelectorAll('.rating-star');
            stars.forEach(s => {
                s.classList.toggle('selected', parseInt(s.dataset.value) <= value);
            });
        }

        async function handleLogSubmit(e) {
            e.preventDefault();
            if (!isFirebaseReady) {
                alert("A conex√£o com a base de dados ainda n√£o est√° pronta. Tente novamente em alguns segundos.");
                return;
            }
            const submitButton = document.getElementById('log-submit-button');
            submitButton.disabled = true;
            submitButton.textContent = 'A registar...';

            const logData = {
                week: parseInt(weekSelect.value),
                hours: parseFloat(document.getElementById('hours-input').value),
                rating: parseInt(ratingValueInput.value),
                notes: document.getElementById('notes-input').value.trim(),
                timestamp: serverTimestamp()
            };

            try {
                const logCollection = collection(db, 'artifacts', appId, 'users', userId, 'studyLogs');
                await addDoc(logCollection, logData);
                logForm.reset();
                updateStarDisplay(0);
                ratingValueInput.value = 0;
            } catch (error) {
                console.error("Error adding document: ", error);
                alert("Ocorreu um erro ao guardar o seu registo.");
            } finally {
                submitButton.disabled = false;
                submitButton.textContent = 'Registar';
            }
        }
        
        function listenToLogs() {
            if (!isFirebaseReady || !userId) return;
            const logCollection = collection(db, 'artifacts', appId, 'users', userId, 'studyLogs');
            const q = query(logCollection);
            onSnapshot(q, (snapshot) => {
                const logs = [];
                snapshot.forEach(doc => {
                    logs.push({ id: doc.id, ...doc.data() });
                });
                logs.sort((a, b) => b.timestamp?.toMillis() - a.timestamp?.toMillis());
                renderLogs(logs);
                updateChartWithLogs(logs);
            });
        }

        function renderLogs(logs) {
            logList.innerHTML = '';
            if (logs.length === 0) {
                logList.appendChild(logPlaceholder);
                return;
            }
            
            logs.forEach(log => {
                const date = log.timestamp ? log.timestamp.toDate().toLocaleDateString('pt-BR') : 'Sem data';
                const starsHTML = Array.from({length: 5}, (_, i) => `<svg class="w-4 h-4 ${i < log.rating ? 'text-amber-400' : 'text-gray-300'}" fill="currentColor" viewBox="0 0 20 20"><path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z" /></svg>`).join('');

                const logEl = document.createElement('div');
                logEl.className = 'border rounded-md p-4 bg-gray-50';
                logEl.innerHTML = `
                    <div class="flex justify-between items-start">
                        <div>
                            <p class="font-bold text-gray-800">Semana ${log.week}</p>
                            <p class="text-sm text-gray-500">${date} - ${log.hours}h</p>
                        </div>
                        <div class="flex">${starsHTML}</div>
                    </div>
                    ${log.notes ? `<p class="mt-2 text-sm text-gray-600 bg-gray-100 p-2 rounded">${log.notes}</p>` : ''}
                `;
                logList.appendChild(logEl);
            });
        }
        
        const progressTitle = document.getElementById('progress-title');

        function updateChartWithLogs(logs) {
            if (!progressChart) return;
            const weeklyHours = Array(studyPlan.length).fill(0);
            logs.forEach(log => {
                if(log.week >= 0 && log.week < weeklyHours.length) {
                    weeklyHours[log.week] += log.hours;
                }
            });

            const totalHours = weeklyHours.reduce((acc, h) => acc + h, 0);
            progressTitle.innerHTML = `A Sua Trilha de Aprendizagem <span class="text-indigo-600 font-bold">(${totalHours.toFixed(1)}h Totais)</span>`;
            
            progressChart.data.datasets[0].data = weeklyHours;
            progressChart.update();
        }

        const coachButton = document.getElementById('coach-button');
        const coachModal = document.getElementById('coach-modal');
        const closeCoachModalButton = document.getElementById('close-coach-modal');
        const chatForm = document.getElementById('chat-form');
        const chatInput = document.getElementById('chat-input');
        const chatWindow = document.getElementById('chat-window');
        const typingIndicator = document.getElementById('typing-indicator');
        let chatHistory = [];
        let isLoading = false;
        const systemPrompt = `Voc√™ √© o 'PyCoach', um assistente de estudos de Python amig√°vel, positivo e encorajador. O seu objetivo √© ajudar um aluno iniciante que est√° a seguir um plano de estudos de 8 semanas. Mantenha as respostas claras, concisas e use uma linguagem simples. Sempre que poss√≠vel, forne√ßa exemplos de c√≥digo curtos e bem explicados. N√£o fuja do t√≥pico de Python e conceitos b√°sicos de programa√ß√£o. Comece a conversa a apresentar-se e a perguntar como pode ajudar.`;
        
        function setupCoach() {
            coachButton.addEventListener('click', openCoach);
            closeCoachModalButton.addEventListener('click', closeCoach);
            coachModal.addEventListener('click', (e) => { if (e.target === coachModal) closeCoach(); });
            chatForm.addEventListener('submit', handleSendMessage);
        }
        function openCoach() {
            coachModal.classList.remove('hidden');
            setTimeout(() => { coachModal.classList.remove('opacity-0', 'scale-95'); }, 10);
            if (chatHistory.length === 0) { addMessageToHistory('model', 'Ol√°! Eu sou o PyCoach, o seu assistente pessoal de estudos. Como posso ajudar a desvendar o mundo do Python hoje?'); }
        }
        function closeCoach() {
            coachModal.classList.add('opacity-0', 'scale-95');
            setTimeout(() => { coachModal.classList.add('hidden'); }, 300);
        }
        function addMessageToHistory(role, text) {
            chatHistory.push({ role, parts: [{ text }] });
            renderChat();
        }
        function renderChat() {
            chatWindow.innerHTML = '';
            chatHistory.forEach(msg => {
                const messageDiv = document.createElement('div');
                messageDiv.className = `coach-message w-fit max-w-xs md:max-w-md p-3 rounded-2xl`;
                messageDiv.classList.add(msg.role === 'user' ? 'user' : 'model');
                let formattedText = msg.parts[0].text.replace(/```python\n([\s\S]*?)```/g, '<pre class="bg-gray-800 text-white p-3 rounded-lg mt-2 text-sm overflow-x-auto"><code>$1</code></pre>');
                formattedText = formattedText.replace(/`([^`]+)`/g, '<code class="bg-gray-200 text-red-600 px-1 rounded">$1</code>');
                messageDiv.innerHTML = formattedText;
                const wrapper = document.createElement('div');
                wrapper.className = 'flex flex-col';
                wrapper.appendChild(messageDiv);
                chatWindow.appendChild(wrapper);
            });
            chatWindow.scrollTop = chatWindow.scrollHeight;
        }
        async function handleSendMessage(e) {
            e.preventDefault();
            const userInput = chatInput.value.trim();
            if (!userInput || isLoading) return;
            addMessageToHistory('user', userInput);
            chatInput.value = '';
            setLoading(true);
            try { await callGeminiAPI(); } catch (error) { console.error('Error calling Gemini API:', error); addMessageToHistory('model', 'Desculpe, ocorreu um erro ao tentar conectar-me. Por favor, tente novamente mais tarde.'); } finally { setLoading(false); }
        }
        function setLoading(state) {
            isLoading = state;
            typingIndicator.classList.toggle('hidden', !state);
            chatInput.disabled = state;
            chatForm.querySelector('button').disabled = state;
        }
        async function callGeminiAPI() {
            const apiKey = "";
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;
            const payload = { contents: chatHistory, systemInstruction: { parts: [{ text: systemPrompt }] }, };
            let response; let delay = 1000;
            for (let i = 0; i < 5; i++) {
                try {
                    response = await fetch(apiUrl, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(payload) });
                    if (response.ok) break;
                } catch (e) {}
                await new Promise(resolve => setTimeout(resolve, delay));
                delay *= 2;
            }
            if (!response || !response.ok) { throw new Error('API request failed after multiple retries'); }
            const result = await response.json();
            const modelResponse = result.candidates?.[0]?.content?.parts?.[0]?.text;
            if (modelResponse) { addMessageToHistory('model', modelResponse); } else { throw new Error('Invalid response structure from API'); }
        }

        document.addEventListener('DOMContentLoaded', () => {
            setupTabs();
            createChart();
            renderPlan(0);
            setupCoach();
            setupProgressTracker();
        });

    </script>
</body>
</html>

